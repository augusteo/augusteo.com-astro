@import "tailwindcss";

/* ========================================
   THEME CONFIGURATION
======================================== */
@theme {
  /* Colors - Watercolor Palette */
  --color-paper: #fdfbf7;
  --color-paper-warm: #f9f5ed;
  --color-ink: #2d3436;
  --color-ink-light: #636e72;
  --color-ink-faint: #b2bec3;

  /* Watercolor Washes (with transparency) */
  --color-wash-sky: oklch(0.8 0.08 220 / 0.3);
  --color-wash-sage: oklch(0.7 0.1 140 / 0.28);
  --color-wash-terracotta: oklch(0.7 0.12 60 / 0.22);
  --color-wash-ocean: oklch(0.65 0.08 200 / 0.25);
  --color-wash-sunset: oklch(0.8 0.1 80 / 0.2);

  /* Accent Colors */
  --color-accent-green: #6b8e23;
  --color-accent-blue: #4682b4;
  --color-accent-terracotta: #cd5c5c;
  --color-accent-ochre: #daa520;

  /* Typography */
  --font-hand: "Caveat", cursive;
  --font-body: "Spectral", Georgia, serif;
  --font-mono: "JetBrains Mono", monospace;

  /* Spacing */
  --content-width: 720px;
  --wide-width: 1100px;
  --photo-width: 1000px;
  --max-photo-width: 1500px;
  --image-width: 864px;  /* 720px * 1.2 = 20% wider than content */
}

/* ========================================
   BASE STYLES
======================================== */
@layer base {
  html {
    font-size: 18px;
    scroll-behavior: smooth;
    overflow-x: hidden;
  }

  body {
    font-family: var(--font-body);
    color: var(--color-ink);
    background: var(--color-paper);
    line-height: 1.7;
    overflow-x: hidden;
  }

  /* Paper texture overlay - using static PNG instead of SVG feTurbulence
     for better scroll/repaint performance */
  body::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    opacity: 0.03;
    background-image: url("/textures/paper-noise.png");
    background-repeat: repeat;
    z-index: 9999;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
}

/* ========================================
   TYPOGRAPHY
======================================== */
@layer components {
  .font-hand {
    font-family: var(--font-hand);
  }

  .font-body {
    font-family: var(--font-body);
  }

  .font-mono {
    font-family: var(--font-mono);
  }

  /* ========================================
     PROSE STYLES
  ======================================== */
  .prose {
    max-width: var(--content-width);
  }

  .prose p {
    margin-bottom: 1.5rem;
  }

  .prose h2 {
    font-family: var(--font-hand);
    font-size: 2rem;
    margin: 3rem 0 1.5rem;
    position: relative;
    padding-left: 1.25rem;
  }

  /* Watercolor accent for h2 */
  .prose h2::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 6px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 40' preserveAspectRatio='none'%3E%3Cdefs%3E%3Cfilter id='h2accent'%3E%3CfeTurbulence baseFrequency='0.1'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='2'/%3E%3C/filter%3E%3C/defs%3E%3Cpath d='M3,0 Q1,10 3,20 T3,40' stroke='%23daa520' stroke-width='5' fill='none' filter='url(%23h2accent)'/%3E%3C/svg%3E");
    background-size: 100% 100%;
  }

  .prose h3 {
    font-family: var(--font-hand);
    font-size: 1.5rem;
    margin: 2rem 0 1rem;
  }

  .prose a {
    color: var(--color-accent-blue);
    text-decoration: none;
    position: relative;
  }

  .prose a::after {
    content: "";
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 3px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 3'%3E%3Cpath d='M0,1.5 Q15,0.5 30,2.5 T60,1.5' stroke='%234682b4' stroke-width='1.5' fill='none' opacity='0.5'/%3E%3C/svg%3E");
    background-size: 100% 100%;
    opacity: 0;
    transition: opacity 0.2s;
  }

  .prose a:hover::after {
    opacity: 1;
  }

  /* Blockquote with watercolor background */
  .prose blockquote {
    margin: 2rem 0;
    padding: 1.5rem 2rem;
    font-style: italic;
    position: relative;
    border-left: none;
  }

  .prose blockquote::before {
    content: "";
    position: absolute;
    inset: 0;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 100' preserveAspectRatio='none'%3E%3Cdefs%3E%3Cfilter id='bqWash'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.02' numOctaves='3'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='15'/%3E%3CfeGaussianBlur stdDeviation='2'/%3E%3C/filter%3E%3C/defs%3E%3Crect x='5' y='5' width='390' height='90' rx='5' fill='%238fbc8f' opacity='0.25' filter='url(%23bqWash)'/%3E%3Cpath d='M3,50 Q5,10 10,8 T30,10' stroke='%236b8e23' stroke-width='3' fill='none' opacity='0.7'/%3E%3C/svg%3E");
    background-size: 100% 100%;
    z-index: -1;
  }

  .prose blockquote p {
    margin-bottom: 0;
  }

  /* Code blocks */
  .prose pre {
    margin: 2rem 0;
    padding: 1.5rem;
    background: #1a1a2e;
    color: #e0e0e0;
    font-family: var(--font-mono);
    font-size: 0.85rem;
    line-height: 1.6;
    overflow-x: auto;
    /* Organic corners */
    border-radius: 8px 16px 12px 20px / 20px 12px 16px 8px;
  }

  .prose pre code {
    padding: 0;
    background: transparent;
  }

  /* Inline code with watercolor blob */
  .prose code:not(pre code) {
    position: relative;
    font-family: var(--font-mono);
    font-size: 0.9em;
    padding: 0.15rem 0.4rem;
  }

  .prose code:not(pre code)::before {
    content: "";
    position: absolute;
    inset: -2px -4px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 24'%3E%3Cdefs%3E%3Cfilter id='codeWash'%3E%3CfeTurbulence baseFrequency='0.08'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='2'/%3E%3C/filter%3E%3C/defs%3E%3Cellipse cx='25' cy='12' rx='24' ry='11' fill='%238fbc8f' opacity='0.35' filter='url(%23codeWash)'/%3E%3C/svg%3E");
    background-size: 100% 100%;
    z-index: -1;
  }

  /* Wide images - break out of content column */
  .prose figure {
    margin: 3rem 0;
    position: relative;
    width: calc(100vw - 4rem);
    max-width: var(--image-width);  /* 864px = 20% wider than content */
    left: 50%;
    transform: translateX(-50%);
  }

  .prose figure img,
  .prose img {
    width: 100%;
    display: block;
    /* Organic shape */
    border-radius: 8px 16px 12px 20px / 12px 8px 20px 16px;
  }

  /* Watercolor frame around images - organic edges with drop-shadows
     Reduced from 4 layers to 2 for better performance */
  .prose figure img,
  .prose p > img,
  .prose img {
    /* Default: Ochre + Gold - warm autumn */
    filter:
      drop-shadow(0 0 4px rgba(218, 165, 32, 0.45))
      drop-shadow(0 0 16px rgba(218, 165, 32, 0.2));
  }

  /* Variation 1: Sage + Olive - earthy green */
  .prose p:nth-of-type(6n+1) > img {
    filter:
      drop-shadow(0 0 4px rgba(143, 188, 143, 0.5))
      drop-shadow(0 0 16px rgba(107, 142, 35, 0.22));
  }

  /* Variation 2: Terracotta + Coral - warm clay */
  .prose p:nth-of-type(6n+2) > img {
    filter:
      drop-shadow(0 0 4px rgba(205, 92, 92, 0.45))
      drop-shadow(0 0 16px rgba(210, 105, 30, 0.2));
  }

  /* Variation 3: Ocean + Sky - cool blue */
  .prose p:nth-of-type(6n+3) > img {
    filter:
      drop-shadow(0 0 4px rgba(70, 130, 180, 0.5))
      drop-shadow(0 0 16px rgba(135, 206, 235, 0.22));
  }

  /* Variation 4: Lavender + Plum - soft purple */
  .prose p:nth-of-type(6n+4) > img {
    filter:
      drop-shadow(0 0 4px rgba(186, 85, 211, 0.42))
      drop-shadow(0 0 16px rgba(147, 112, 219, 0.2));
  }

  /* Variation 5: Sunset + Peach - warm orange/pink */
  .prose p:nth-of-type(6n+5) > img {
    filter:
      drop-shadow(0 0 4px rgba(255, 160, 122, 0.45))
      drop-shadow(0 0 16px rgba(255, 182, 193, 0.22));
  }

  /* Variation 6: Teal + Mint - fresh aqua */
  .prose p:nth-of-type(6n) > img {
    filter:
      drop-shadow(0 0 4px rgba(0, 128, 128, 0.45))
      drop-shadow(0 0 16px rgba(64, 224, 208, 0.2));
  }

  .prose figcaption {
    font-family: var(--font-hand);
    font-size: 1.1rem;
    color: var(--color-ink-light);
    text-align: center;
    padding: 0.75rem 2rem;
    position: relative;
  }

  .prose figcaption::before {
    content: "";
    position: absolute;
    inset: 0;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 40' preserveAspectRatio='none'%3E%3Cdefs%3E%3Cfilter id='capWash'%3E%3CfeTurbulence baseFrequency='0.03'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='5'/%3E%3C/filter%3E%3C/defs%3E%3Crect x='50' y='5' width='300' height='30' fill='%23deb887' opacity='0.25' filter='url(%23capWash)'/%3E%3C/svg%3E");
    background-size: 100% 100%;
    z-index: -1;
  }

  /* Lists */
  .prose ul,
  .prose ol {
    margin: 1.5rem 0;
    padding-left: 1.5rem;
  }

  .prose li {
    margin-bottom: 0.5rem;
  }

  .prose li::marker {
    color: var(--color-accent-terracotta);
  }

  /* Horizontal rule */
  .prose hr {
    border: none;
    height: 30px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 30'%3E%3Cpath d='M20,15 Q60,10 100,16 T180,13 T260,17 T340,14 T380,15' stroke='%23b2bec3' stroke-width='1.5' fill='none'/%3E%3Ccircle cx='200' cy='15' r='4' fill='%23cd853f' opacity='0.6'/%3E%3Cpath d='M190,15 L195,10 M210,15 L205,10' stroke='%23cd853f' stroke-width='1' opacity='0.4'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: center;
    background-size: 100% 100%;
    margin: 3rem 0;
  }

  /* ========================================
     ORGANIC BUTTON STYLE
  ======================================== */
  .btn-organic {
    font-family: var(--font-hand);
    font-size: 1.2rem;
    padding: 0.5rem 1.2rem;
    background: transparent;
    border: none;
    color: var(--color-ink);
    text-decoration: none;
    position: relative;
    cursor: pointer;
    transition: transform 0.2s;
    display: inline-block;
  }

  .btn-organic::before {
    content: "";
    position: absolute;
    inset: -4px -8px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 50'%3E%3Cdefs%3E%3Cfilter id='btnWash'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.03' numOctaves='2'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='8'/%3E%3CfeGaussianBlur stdDeviation='0.5'/%3E%3C/filter%3E%3C/defs%3E%3Cellipse cx='60' cy='25' rx='55' ry='20' fill='%2387ceeb' opacity='0.35' filter='url(%23btnWash)'/%3E%3Cpath d='M8,25 Q10,10 30,8 T60,10 T90,8 T112,25 Q110,40 90,42 T60,40 T30,42 T8,25' stroke='%232d3436' stroke-width='1.5' fill='none' opacity='0.7'/%3E%3C/svg%3E");
    background-size: 100% 100%;
    z-index: -1;
    transition: transform 0.2s;
  }

  .btn-organic:hover {
    transform: translate(-2px, -2px);
  }

  .btn-organic:hover::before {
    transform: translate(2px, 2px);
  }

  .btn-organic.sage::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 50'%3E%3Cdefs%3E%3Cfilter id='btnWashSage'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.03' numOctaves='2'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='8'/%3E%3CfeGaussianBlur stdDeviation='0.5'/%3E%3C/filter%3E%3C/defs%3E%3Cellipse cx='60' cy='25' rx='55' ry='20' fill='%238fbc8f' opacity='0.4' filter='url(%23btnWashSage)'/%3E%3Cpath d='M8,25 Q10,10 30,8 T60,10 T90,8 T112,25 Q110,40 90,42 T60,40 T30,42 T8,25' stroke='%232d3436' stroke-width='1.5' fill='none' opacity='0.7'/%3E%3C/svg%3E");
  }

  .btn-organic.terracotta::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 50'%3E%3Cdefs%3E%3Cfilter id='btnWashTerra'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.03' numOctaves='2'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='8'/%3E%3CfeGaussianBlur stdDeviation='0.5'/%3E%3C/filter%3E%3C/defs%3E%3Cellipse cx='60' cy='25' rx='55' ry='20' fill='%23cd853f' opacity='0.35' filter='url(%23btnWashTerra)'/%3E%3Cpath d='M8,25 Q10,10 30,8 T60,10 T90,8 T112,25 Q110,40 90,42 T60,40 T30,42 T8,25' stroke='%232d3436' stroke-width='1.5' fill='none' opacity='0.7'/%3E%3C/svg%3E");
  }
}

/* ========================================
   VIEW TRANSITIONS - Watercolor Theme
======================================== */
::view-transition-old(root) {
  animation: 200ms ease-out both fade-blur-out;
}

::view-transition-new(root) {
  animation: 250ms ease-out 50ms both fade-blur-in;
}

@keyframes fade-blur-out {
  to {
    opacity: 0;
    filter: blur(4px);
  }
}

@keyframes fade-blur-in {
  from {
    opacity: 0;
    filter: blur(4px);
  }
}

/* ========================================
   REDUCED MOTION PREFERENCES
======================================== */
@media (prefers-reduced-motion: reduce) {
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation: none;
  }

  /* Disable paper texture */
  body::before {
    display: none;
  }

  /* Simplify image shadows to single layer */
  .prose figure img,
  .prose p > img,
  .prose img {
    filter: drop-shadow(0 0 8px rgba(0, 0, 0, 0.15)) !important;
  }

  /* Disable watercolor decorations */
  .prose h2::before,
  .prose a::after,
  .prose blockquote::before,
  .prose code:not(pre code)::before,
  .prose figcaption::before,
  .prose hr,
  .btn-organic::before {
    display: none !important;
    background: none !important;
  }

  /* Disable hover transforms */
  .btn-organic:hover {
    transform: none;
  }
}

/* ========================================
   RESPONSIVE
======================================== */
@media (max-width: 768px) {
  html {
    font-size: 16px;
  }

  .prose figure {
    width: calc(100vw - 2rem);
    max-width: 100%;
  }

  /* Replace drop-shadow with box-shadow on mobile for better performance */
  .prose figure img,
  .prose p > img,
  .prose img {
    filter: none !important;
    box-shadow:
      0 2px 8px rgba(218, 165, 32, 0.25),
      0 4px 16px rgba(0, 0, 0, 0.1);
  }

  /* Reduce paper texture opacity on mobile */
  body::before {
    opacity: 0.015;
  }
}

/* Touch devices - disable hover underline effects on links */
@media (pointer: coarse) {
  .prose a::after {
    display: none;
  }
}
